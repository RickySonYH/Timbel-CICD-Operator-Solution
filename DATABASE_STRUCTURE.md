# ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡° ê°€ì´ë“œ - Timbel CI/CD Operator

## **ğŸ“Š ë°ì´í„°ë² ì´ìŠ¤ ë¶„ë¦¬ êµ¬ì¡°**

### **ğŸ¯ ë°ì´í„°ë² ì´ìŠ¤ ë¶„ë¦¬ ì›ì¹™**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PostgreSQL ì„œë²„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“š timbel_knowledge     â”‚  ğŸš€ timbel_cicd_operator         â”‚
â”‚  (ì§€ì‹ìì› ê´€ë¦¬)         â”‚  (ìš´ì˜ì„¼í„° ê´€ë¦¬)                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ ì‚¬ìš©ì ê´€ë¦¬           â”‚  â€¢ CI/CD íŒŒì´í”„ë¼ì¸              â”‚
â”‚  â€¢ ë„ë©”ì¸/í”„ë¡œì íŠ¸/ì‹œìŠ¤í…œâ”‚  â€¢ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬                 â”‚
â”‚  â€¢ ì§€ì‹ ìì‚°             â”‚  â€¢ ë°°í¬ ê´€ë¦¬                     â”‚
â”‚  â€¢ ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°       â”‚  â€¢ ëª¨ë‹ˆí„°ë§ & ì•Œë¦¼               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## **ğŸ“š timbel_knowledge ë°ì´í„°ë² ì´ìŠ¤**

### **ğŸ” ì‚¬ìš©ì ê´€ë¦¬**
- **timbel_users**: ì „ì²´ ì‚¬ìš©ì ê³„ì • (admin, operator, user)
- **user_sessions**: ë¡œê·¸ì¸ ì„¸ì…˜ ê´€ë¦¬

### **ğŸ¢ ì§€ì‹ìì› ì¹´íƒˆë¡œê·¸**
- **domains**: ì˜ì—…ì²˜ ì •ë³´
- **projects**: í”„ë¡œì íŠ¸ ì •ë³´
- **systems**: ì‹œìŠ¤í…œ ì •ë³´
- **components**: ì½”ë“œ ì»´í¬ë„ŒíŠ¸
- **knowledge_assets**: ì§€ì‹ ìì‚°
- **apis**: API ì •ë³´

### **ğŸ“‹ í”„ë¡œì íŠ¸ ê´€ë ¨**
- **project_documents**: í”„ë¡œì íŠ¸ ë¬¸ì„œ
- **project_similar_systems**: ìœ ì‚¬ ì‹œìŠ¤í…œ
- **project_work_groups**: ì‘ì—… ê·¸ë£¹
- **project_git_analytics**: Git ë¶„ì„ ë°ì´í„°

### **âœ… ìŠ¹ì¸ ê´€ë¦¬**
- **approval_workflows**: ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°

---

## **ğŸš€ timbel_cicd_operator ë°ì´í„°ë² ì´ìŠ¤**

### **ğŸ”„ CI/CD íŒŒì´í”„ë¼ì¸**
- **jenkins_jobs**: Jenkins ì‘ì—… ê´€ë¦¬
- **nexus_image_pushes**: Nexus ì´ë¯¸ì§€ í‘¸ì‹œ ì´ë ¥
- **nexus_tag_operations**: Nexus íƒœê·¸ ì‘ì—…
- **argocd_applications**: Argo CD ì• í”Œë¦¬ì¼€ì´ì…˜
- **argocd_sync_operations**: Argo CD ë™ê¸°í™” ì‘ì—…
- **argocd_promotions**: Argo CD í”„ë¡œëª¨ì…˜
- **github_webhooks**: GitHub ì›¹í›… ì„¤ì •

### **â˜¸ï¸ í´ëŸ¬ìŠ¤í„° ê´€ë¦¬**
- **kubernetes_clusters**: Kubernetes í´ëŸ¬ìŠ¤í„° ì •ë³´
- **cluster_namespaces**: í´ëŸ¬ìŠ¤í„° ë„¤ì„ìŠ¤í˜ì´ìŠ¤
- **cluster_deployments**: í´ëŸ¬ìŠ¤í„° ë°°í¬ ì´ë ¥

### **ğŸ“Š ëª¨ë‹ˆí„°ë§ & ì•Œë¦¼**
- **prometheus_metrics_collection**: Prometheus ë©”íŠ¸ë¦­
- **prometheus_alert_rules**: Prometheus ì•Œë¦¼ ê·œì¹™
- **prometheus_alerts**: Prometheus ì•Œë¦¼
- **sla_calculations**: SLA ê³„ì‚° ê²°ê³¼
- **sla_metrics**: SLA ë©”íŠ¸ë¦­
- **sla_alerts**: SLA ì•Œë¦¼
- **monitored_servers**: ëª¨ë‹ˆí„°ë§ ì„œë²„ ëª©ë¡
- **monitoring_configurations**: ëª¨ë‹ˆí„°ë§ ì„¤ì •

### **ğŸš€ ë°°í¬ ê´€ë¦¬**
- **operations_deployments**: ë°°í¬ ì‘ì—… ì´ë ¥
- **operations_pipelines**: ìš´ì˜ íŒŒì´í”„ë¼ì¸
- **operations_build_history**: ë¹Œë“œ íˆìŠ¤í† ë¦¬
- **operations_alerts**: ìš´ì˜ ì•Œë¦¼
- **operations_infrastructures**: ì¸í”„ë¼ ê´€ë¦¬
- **operations_infrastructure_nodes**: ì¸í”„ë¼ ë…¸ë“œ
- **operations_tenants**: í…Œë„ŒíŠ¸ ê´€ë¦¬
- **operations_tenant_services**: í…Œë„ŒíŠ¸ ì„œë¹„ìŠ¤
- **operations_service_monitoring**: ì„œë¹„ìŠ¤ ëª¨ë‹ˆí„°ë§
- **pipeline_template_applications**: íŒŒì´í”„ë¼ì¸ í…œí”Œë¦¿

### **ğŸ› ì´ìŠˆ ê´€ë¦¬**
- **issues**: ì´ìŠˆ ê´€ë¦¬
- **issue_history**: ì´ìŠˆ íˆìŠ¤í† ë¦¬
- **issue_notifications**: ì´ìŠˆ ì•Œë¦¼

### **ğŸ“ ë¡œê¹…**
- **cicd_pipeline_logs**: CI/CD íŒŒì´í”„ë¼ì¸ ë¡œê·¸

---

## **ğŸ”— ë°±ì—”ë“œ API ë¼ìš°íŒ… êµ¬ì¡°**

### **ğŸ“š ì§€ì‹ìì› ê´€ë ¨ API** (`timbel_knowledge` DB ì‚¬ìš©)
```javascript
// backend/src/routes/knowledge.js
app.use('/api/knowledge', require('./routes/knowledge'));
app.use('/api/auth', require('./routes/auth')); // ì‚¬ìš©ì ì¸ì¦

// ì ‘ì† DB: timbel_knowledge
// í…Œì´ë¸”: timbel_users, domains, projects, systems, components, etc.
```

### **ğŸš€ ìš´ì˜ì„¼í„° ê´€ë ¨ API** (`timbel_cicd_operator` DB ì‚¬ìš©)
```javascript
// backend/src/routes/
app.use('/api/jenkins', require('./routes/jenkins-automation'));
app.use('/api/nexus', require('./routes/nexus-integration'));
app.use('/api/argocd', require('./routes/argocd-integration'));
app.use('/api/prometheus', require('./routes/prometheus-integration'));
app.use('/api/issues', require('./routes/issues-management'));
app.use('/api/clusters', require('./routes/cluster-management'));
app.use('/api/operations', require('./routes/operations-dashboard'));

// ì ‘ì† DB: timbel_cicd_operator
// í…Œì´ë¸”: jenkins_jobs, nexus_*, argocd_*, kubernetes_clusters, etc.
```

---

## **âš ï¸ ì£¼ì˜ì‚¬í•­ ë° í•´ê²° ë°©ì•ˆ**

### **ğŸ”„ Cross-Database ì¡°ì¸ ë¬¸ì œ**
**ë¬¸ì œ**: ì„œë¡œ ë‹¤ë¥¸ DBì˜ í…Œì´ë¸”ì„ ì¡°ì¸í•  ìˆ˜ ì—†ìŒ
```sql
-- âŒ ë¶ˆê°€ëŠ¥
SELECT p.name, od.status 
FROM timbel_knowledge.projects p 
JOIN timbel_cicd_operator.operations_deployments od ON p.id = od.project_id
```

**í•´ê²° ë°©ì•ˆ**:
```javascript
// âœ… ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ì—ì„œ ë°ì´í„° í†µí•©
const [projectsRes, deploymentsRes] = await Promise.all([
  knowledgeDB.query('SELECT * FROM projects'),
  operationsDB.query('SELECT * FROM operations_deployments')
]);

// ë©”ëª¨ë¦¬ì—ì„œ ì¡°ì¸
const integratedData = projects.map(project => ({
  ...project,
  deployment: deployments.find(d => d.project_name === project.name)
}));
```

### **ğŸ” ì¸ì¦ ë¬¸ì œ í•´ê²°**
**ë¬¸ì œ**: ì‚¬ìš©ì í…Œì´ë¸”ì´ `timbel_knowledge` DBì— ìˆìŒ
```javascript
// âœ… auth.jsì—ì„œ ì˜¬ë°”ë¥¸ DB ì—°ê²° í™•ì¸
const knowledgePool = new Pool({
  database: 'timbel_knowledge'  // ì‚¬ìš©ì ì¸ì¦ìš©
});

const operationsPool = new Pool({
  database: 'timbel_cicd_operator'  // ìš´ì˜ì„¼í„°ìš©
});
```

### **ğŸ“Š í†µê³„ API í†µí•©**
```javascript
// âœ… ëŒ€ì‹œë³´ë“œì—ì„œ ë‘ DB ë°ì´í„° í†µí•©
const loadExecutiveMetrics = async () => {
  const [knowledgeStats, operationsStats, clusterStats] = await Promise.all([
    fetch('/api/knowledge/catalog-stats'),    // timbel_knowledge
    fetch('/api/operations/dashboard-stats'), // timbel_cicd_operator  
    fetch('/api/clusters/clusters/statistics') // timbel_cicd_operator
  ]);
};
```

---

## **ğŸ› ï¸ í–¥í›„ ê°œë°œ ê°€ì´ë“œë¼ì¸**

### **1. ìƒˆ ê¸°ëŠ¥ ì¶”ê°€ ì‹œ DB ì„ íƒ ê¸°ì¤€**

#### **ğŸ“š timbel_knowledgeì— ì¶”ê°€í•´ì•¼ í•˜ëŠ” ê²½ìš°:**
- âœ… ì‚¬ìš©ì/ê¶Œí•œ ê´€ë ¨
- âœ… ë„ë©”ì¸/í”„ë¡œì íŠ¸/ì‹œìŠ¤í…œ ì •ë³´
- âœ… ì§€ì‹ ìì‚° (ì½”ë“œ, ë¬¸ì„œ, ë””ìì¸)
- âœ… ìŠ¹ì¸ ì›Œí¬í”Œë¡œìš°

#### **ğŸš€ timbel_cicd_operatorì— ì¶”ê°€í•´ì•¼ í•˜ëŠ” ê²½ìš°:**
- âœ… CI/CD íŒŒì´í”„ë¼ì¸ ê´€ë ¨
- âœ… í´ëŸ¬ìŠ¤í„°/ë°°í¬ ê´€ë ¨
- âœ… ëª¨ë‹ˆí„°ë§/ì•Œë¦¼ ê´€ë ¨
- âœ… ìš´ì˜ ë¡œê·¸/ì´ë²¤íŠ¸

### **2. API ë¼ìš°íŠ¸ ëª…ëª… ê·œì¹™**

```javascript
// ì§€ì‹ìì› ê´€ë ¨
/api/knowledge/*     â†’ timbel_knowledge DB
/api/auth/*          â†’ timbel_knowledge DB (timbel_users)

// ìš´ì˜ì„¼í„° ê´€ë ¨  
/api/jenkins/*       â†’ timbel_cicd_operator DB
/api/nexus/*         â†’ timbel_cicd_operator DB
/api/argocd/*        â†’ timbel_cicd_operator DB
/api/clusters/*      â†’ timbel_cicd_operator DB
/api/operations/*    â†’ timbel_cicd_operator DB
/api/prometheus/*    â†’ timbel_cicd_operator DB
/api/issues/*        â†’ timbel_cicd_operator DB
```

### **3. ë°ì´í„° í†µí•© íŒ¨í„´**

```javascript
// âœ… ê¶Œì¥ íŒ¨í„´: ë³‘ë ¬ ì¡°íšŒ í›„ ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ í†µí•©
const loadIntegratedData = async () => {
  const [knowledgeData, operationsData] = await Promise.all([
    fetchFromKnowledgeDB(),
    fetchFromOperationsDB()
  ]);
  
  return mergeData(knowledgeData, operationsData);
};
```

### **4. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •**

```javascript
// backend/src/config/database.js
const knowledgePool = new Pool({
  host: process.env.DB_HOST || 'postgres',
  database: 'timbel_knowledge',
  user: process.env.DB_USER || 'timbel_user',
  password: process.env.DB_PASSWORD || 'timbel_password'
});

const operationsPool = new Pool({
  host: process.env.DB_HOST || 'postgres', 
  database: 'timbel_cicd_operator',
  user: process.env.DB_USER || 'timbel_user',
  password: process.env.DB_PASSWORD || 'timbel_password'
});
```

---

## **ğŸ”§ í˜„ì¬ ë°±ì—”ë“œ ë¼ìš°íŠ¸ ìˆ˜ì • í•„ìš”ì‚¬í•­**

### **ì¸ì¦ ê´€ë ¨ ìˆ˜ì • í•„ìš”:**
```javascript
// backend/src/routes/auth.js
// âŒ í˜„ì¬: ì˜ëª»ëœ DB ì°¸ì¡°
// âœ… ìˆ˜ì • í•„ìš”: timbel_knowledge DBì˜ timbel_users í…Œì´ë¸” ì‚¬ìš©
```

### **í¬ë¡œìŠ¤ DB ì¡°íšŒê°€ í•„ìš”í•œ API:**
```javascript
// backend/src/routes/operations-dashboard.js
// í”„ë¡œì íŠ¸ ì •ë³´(knowledge) + ë°°í¬ í˜„í™©(operations) í†µí•© í•„ìš”

// backend/src/routes/executive-dashboard.js  
// ëª¨ë“  DB í†µê³„ í†µí•© í•„ìš”
```

---

## **ğŸ“‹ ì¦‰ì‹œ ìˆ˜ì • í•„ìš”í•œ í•­ëª©**

1. **ì¸ì¦ API**: `timbel_users` í…Œì´ë¸” ì°¸ì¡° ìˆ˜ì •
2. **ëŒ€ì‹œë³´ë“œ API**: Cross-DB ë°ì´í„° í†µí•© ë¡œì§ ì¶”ê°€  
3. **í™˜ê²½ ì„¤ì •**: DB ì—°ê²° í’€ ë¶„ë¦¬
4. **ì—ëŸ¬ í•¸ë“¤ë§**: DBë³„ ì—ëŸ¬ ì²˜ë¦¬ ë¶„ë¦¬

---

## **âœ… í–¥í›„ ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸**

ìƒˆ ê¸°ëŠ¥ ê°œë°œ ì‹œ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

- [ ] ì–´ëŠ DBì— ì €ì¥í• ì§€ ê²°ì • (ì§€ì‹ìì› vs ìš´ì˜ì„¼í„°)
- [ ] ì˜¬ë°”ë¥¸ DB ì—°ê²° í’€ ì‚¬ìš©
- [ ] Cross-DB ì¡°íšŒ í•„ìš” ì‹œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ í†µí•©
- [ ] API ë¼ìš°íŠ¸ ëª…ëª… ê·œì¹™ ì¤€ìˆ˜
- [ ] í…Œì´ë¸”ëª… ì¤‘ë³µ ë°©ì§€ (ë‘ DB ëª¨ë‘ í™•ì¸)

ì´ ë¬¸ì„œë¥¼ ì°¸ê³ í•˜ì—¬ í–¥í›„ ê°œë°œí•˜ì‹œë©´ í˜¼ë€ì„ ë°©ì§€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ¯
